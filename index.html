<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>INTERPARK PRACTICE</title>

<style>
body{
  margin:0;
  font-family:-apple-system,system-ui;
  background:#f4f7fb;
}
#app{
  max-width:420px;
  margin:0 auto;
  padding:16px;
}
h1{
  text-align:center;
  color:#0066cc;
  font-weight:800;
}
button{
  width:100%;
  padding:14px;
  font-size:16px;
  background:#0066cc;
  color:white;
  border:none;
  border-radius:8px;
  margin-top:12px;
}
.card{
  background:white;
  border-radius:12px;
  padding:16px;
  margin-top:12px;
}
.center{text-align:center;}
.small{font-size:13px;color:#777;}

.block{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:6px;
}
.zone{
  padding:16px 0;
  border-radius:8px;
  text-align:center;
  font-weight:700;
}
.floor{background:#ff6b6b;}
.one{background:#ffd43b;}
.two{background:#69db7c;}

.seat-wrap{
  height:50vh;
  overflow-x:auto;
  background:white;
  border-radius:12px;
  padding:10px;
}
.seats{
  display:grid;
  grid-template-columns:repeat(18,1fr);
  gap:4px;
  min-width:700px;
}
.seat{
  height:14px;
  border-radius:2px;
}
.free{background:#2db400;}
.taken{background:#888;}

.rank{
  font-size:14px;
  margin-top:6px;
}
</style>
</head>

<body>
<div id="app">
  <h1>INTERPARK</h1>
  <div id="screen"></div>
</div>

<script>
const screen = document.getElementById("screen");
let queue = Math.floor(Math.random()*50000)+1;
let canClick=false;
let lastClick=0;

/* ë­í‚¹ */
function saveRank(){
  const r = JSON.parse(localStorage.getItem("rank")||"[]");
  r.push(queue);
  r.sort((a,b)=>a-b);
  localStorage.setItem("rank",JSON.stringify(r.slice(0,10)));
}
function rankUI(){
  const r = JSON.parse(localStorage.getItem("rank")||"[]");
  return r.map((v,i)=>`<div class="rank">${i+1}ìœ„ : ${v}ë²ˆ</div>`).join("");
}

/* ì‹œì‘ */
function start(){
  screen.innerHTML=`
    <div class="card center">
      <p>í‹°ì¼“íŒ… ì—°ìŠµ</p>
      ${rankUI()}
    </div>
    <button onclick="count()">ì‹œì‘í•˜ê¸°</button>
  `;
}

/* ì¹´ìš´íŠ¸ */
function count(){
  let c=5;
  canClick=false;
  screen.innerHTML=`
    <div class="card center">
      <h2 id="cnt">5</h2>
    </div>
    <button onclick="wait()">ì‹œì‘í•˜ê¸°</button>
  `;
  const t=setInterval(()=>{
    c--;
    document.getElementById("cnt").innerText=c;
    if(c===0){
      canClick=true;
      clearInterval(t);
    }
  },1000);
}

/* ëŒ€ê¸° */
function wait(){
  if(!canClick) return;
  lastClick=Date.now();
  setTimeout(()=>{
    if(Date.now()-lastClick>=0){
      screen.innerHTML=`
        <div class="card center">
          <p>ëŒ€ê¸° ìˆœë²ˆ</p>
          <h2>${queue}ë²ˆ</h2>
        </div>
      `;
      setTimeout(zoneSelect,3000);
    }
  },0);
}

/* êµ¬ì—­ */
function zoneSelect(){
  screen.innerHTML=`
    <div class="block">
      ${[
        2,2,2,1,1,'F','F',1,1,2,2,2,
        2,2,2,2,1,1,1,1,2,2,2,2
      ].map(z=>{
        const c=z==='F'?'floor':z===1?'one':'two';
        const t=z==='F'?'FLOOR':z+'ì¸µ';
        return `<div class="zone ${c}" onclick="seat('${c}')">${t}</div>`;
      }).join("")}
    </div>
  `;
}

/* ì¢Œì„ */
function seat(zone){
  const rate={floor:0.97,one:0.85,two:0.55}[zone];
  let locked=false;
  screen.innerHTML=`
    <button onclick="zoneSelect()">â† êµ¬ì—­ ë‹¤ì‹œ ì„ íƒ</button>
    <div class="seat-wrap">
      <div class="seats">
        ${Array.from({length:180},()=>{
          const taken=Math.random()<rate;
          return `<div class="seat ${taken?'taken':'free'}"
            onclick="${
              taken
              ? "this.style.background='#555';this.onclick=null;alert('ì´ë¯¸ ì„ íƒëœ ì¢Œì„ì…ë‹ˆë‹¤')"
              : "finish()"
            }"></div>`;
        }).join("")}
      </div>
    </div>
  `;
}

/* ì„±ê³µ */
function finish(){
  saveRank();
  screen.innerHTML=`
    <div class="card center">
      <h2>ğŸ‰ ì˜ˆë§¤ ì„±ê³µ</h2>
      <button onclick="location.reload()">ë‹¤ì‹œ ì—°ìŠµ</button>
    </div>
  `;
}

start();
</script>
</body>
</html>