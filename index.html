<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>INTERPARK SIM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:-apple-system;
  background:#f5f7fa;
  text-align:center;
}
.hidden{display:none}
h1{margin:30px 0;color:#1a4cff}

button{
  border:none;
  border-radius:8px;
  padding:16px;
  font-size:16px;
}

.primary{
  background:#1a4cff;
  color:white;
  width:90%;
  max-width:360px;
}

#count{
  font-size:40px;
  margin:20px 0;
}

#msg{
  font-size:18px;
  margin-top:10px;
  color:#1a4cff;
}

.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
  max-width:340px;
  margin:20px auto;
}

.day{
  padding:14px 0;
  background:#eee;
  border-radius:6px;
}
.day.active{background:#1a4cff;color:white}

.seat-grid{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:6px;
  max-width:360px;
  margin:20px auto;
}

.seat{
  aspect-ratio:1/1;
  border-radius:6px;
}

.floor{background:#9ddcff}
.floor.ok{background:#7fcfff}

.one{background:#1a4cff}
.one.ok{background:#4f7dff}

.two{background:#ff8fcf}
.two.ok{background:#ffb3df}

.block{filter:grayscale(1);opacity:0.4}

#modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.4);
  display:flex;
  align-items:center;
  justify-content:center;
}
#modalBox{
  background:white;
  padding:30px;
  border-radius:12px;
  width:80%;
  max-width:300px;
}
</style>
</head>

<body>

<h1>INTERPARK</h1>

<div id="startScreen">
  <div id="count">5</div>
  <div id="msg"></div>
  <button class="primary" id="startBtn">ì‹œì‘í•˜ê¸°</button>
</div>

<div id="main" class="hidden"></div>

<div id="modal" class="hidden">
  <div id="modalBox">
    <div>ì´ë¯¸ ì„ íƒëœ ì¢Œì„ì…ë‹ˆë‹¤</div><br>
    <button class="primary" onclick="closeModal()">í™•ì¸</button>
  </div>
</div>

<script>
const startBtn = document.getElementById("startBtn");
const countEl = document.getElementById("count");
const msgEl = document.getElementById("msg");
const main = document.getElementById("main");
const modal = document.getElementById("modal");

let seatTry = 0;
let waitNum = 0;

// ì‹œì‘ ë²„íŠ¼ í´ë¦­ â†’ ì¹´ìš´íŠ¸ ì‹œì‘
startBtn.onclick = () => {
  startBtn.disabled = true;
  let t = 5;
  countEl.innerText = t;
  msgEl.innerText = "";

  const timer = setInterval(() => {
    t--;
    countEl.innerText = t;

    if (t === 1) {
      msgEl.innerText = "ì˜ˆë§¤ ì‹œì‘";
    }

    if (t === 0) {
      clearInterval(timer);
      // ğŸ”¥ 1ì´ ëë‚˜ë©´ ìë™ìœ¼ë¡œ ì‹œì‘í•˜ê¸°ê°€ ëˆŒë¦° íš¨ê³¼
      goWaiting();
    }
  }, 1000);
};

// ëŒ€ê¸° ìˆœë²ˆ
function goWaiting(){
  document.getElementById("startScreen").classList.add("hidden");
  main.classList.remove("hidden");

  waitNum = Math.floor(Math.random() * 40000) + 7000;

  main.innerHTML = `
    <h2>ëŒ€ê¸° ìˆœë²ˆ</h2>
    <div style="font-size:24px">${waitNum}ë²ˆì§¸</div>
    <div style="margin-top:8px;color:#666">í˜„ì¬ ëŒ€ê¸°ì¸ì› 50,000ëª…</div>
    <div style="margin-top:12px">ì ì‹œ í›„ ìë™ ì…ì¥í•©ë‹ˆë‹¤</div>
  `;

  setTimeout(showCalendar, 5000);
}

// ë‹¬ë ¥
function showCalendar(){
  main.innerHTML = `
    <h2>ë‚ ì§œ ì„ íƒ</h2>
    <div class="calendar">
      <div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div>
      <div></div><div></div>
      <div class="day active" onclick="showSeat()">27</div>
      <div class="day active" onclick="showSeat()">28</div>
    </div>
  `;
}

// ì¢Œì„
function showSeat(){
  seatTry = 0;

  const layout = [
    "1","1","F","F","1","1",
    "1","1","F","F","1","1",
    "2","1","1","1","1","2",
    "2","1","1","1","1","2",
    "2","2","2","2","2","2",
    "2","2","2","2","2","2"
  ];

  const openSet = new Set();
  while(openSet.size < 12){
    openSet.add(Math.floor(Math.random() * 36));
  }

  let html = `<h2>ì¢Œì„ ì„ íƒ</h2><div class="seat-grid">`;

  layout.forEach((z,i)=>{
    let cls = z==="F" ? "floor" : z==="1" ? "one" : "two";
    if(openSet.has(i)){
      html += `<div class="seat ${cls} ok" onclick="trySeat()"></div>`;
    }else{
      html += `<div class="seat ${cls} block"></div>`;
    }
  });

  html += `</div>`;
  main.innerHTML = html;
}

// ì¢Œì„ ì‹œë„
function trySeat(){
  seatTry++;
  if(Math.random() < 0.1){
    main.innerHTML = `
      <h2>ğŸ‰ ì˜ˆë§¤ ì„±ê³µ</h2>
      <div>ì¢Œì„ ì‹œë„ ${seatTry}íšŒ</div><br>
      <button class="primary" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</button>
    `;
  }else{
    modal.classList.remove("hidden");
  }
}

function closeModal(){
  modal.classList.add("hidden");
}
</script>

</body>
</html>