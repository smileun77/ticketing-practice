<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>INTERPARK TICKETING PRACTICE</title>

<style>
body{
  margin:0;
  font-family:-apple-system, BlinkMacSystemFont, system-ui;
  background:#f4f7fb;
}
#app{
  max-width:420px;
  margin:0 auto;
  padding:16px;
}
h1{
  text-align:center;
  color:#0066cc;
  font-weight:800;
}
button{
  width:100%;
  padding:14px;
  font-size:16px;
  background:#0066cc;
  color:white;
  border:none;
  border-radius:8px;
  margin-top:12px;
  display:block;
}
.card{
  background:white;
  border-radius:10px;
  padding:14px;
  margin-top:12px;
}
.center{text-align:center;}

.seat-zone{margin-top:14px;}
.zone-title{font-weight:700;margin-bottom:6px;}
.seats{
  display:grid;
  grid-template-columns:repeat(12,1fr);
  gap:3px;
}
.seat{
  height:14px;
  border-radius:2px;
}
.free{background:#2db400;}
.taken{background:#888;}
</style>
</head>

<body>
<div id="app">
  <h1>INTERPARK</h1>
  <div id="screen"></div>
</div>

<script>
const screen = document.getElementById("screen");
let queue = Math.floor(Math.random()*50000)+1;
let startTime = 0;

/* ì‹œì‘ í™”ë©´ */
function start(){
  screen.innerHTML = `
    <div class="card center">
      <p>5ë§Œ ëª… ë™ì‹œ ì ‘ì† ì¤‘</p>
    </div>
    <button onclick="countdown()">ì‹œì‘í•˜ê¸°</button>
  `;
}

/* ì¹´ìš´íŠ¸ë‹¤ìš´ */
function countdown(){
  let c = 5;
  screen.innerHTML = `
    <div class="card center">
      <h2 id="cnt">5</h2>
      <p>ì˜ˆë§¤ ì‹œì‘ê¹Œì§€</p>
    </div>
  `;
  const timer = setInterval(()=>{
    c--;
    document.getElementById("cnt").innerText = c;
    if(c===0){
      clearInterval(timer);
      ready();
    }
  },1000);
}

/* ëŒ€ê¸° ìˆœë²ˆ */
function ready(){
  startTime = performance.now();
  screen.innerHTML = `
    <div class="card center">
      <p>ëŒ€ê¸°ìˆœë²ˆ</p>
      <h2>${queue}ë²ˆ</h2>
    </div>
    <button onclick="captcha()">ì˜ˆë§¤í•˜ê¸°</button>
  `;
}

/* ë³´ì•ˆë¬¸ì */
function captcha(){
  const code = Array.from({length:5},
    ()=>String.fromCharCode(65+Math.random()*26|0)
  ).join("");

  screen.innerHTML = `
    <div class="card center">
      <p>ë³´ì•ˆë¬¸ì ì…ë ¥</p>
      <h2>${code}</h2>
      <input id="cap" placeholder="ì˜ë¬¸ ëŒ€ë¬¸ì" style="width:100%;padding:12px;font-size:16px;">
      <button onclick="checkCap('${code}')">í™•ì¸</button>
    </div>
  `;
}

function checkCap(code){
  if(document.getElementById("cap").value !== code){
    alert("ë³´ì•ˆë¬¸ìê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
    captcha();
    return;
  }
  dateSelect();
}

/* ë‚ ì§œ ì„ íƒ */
function dateSelect(){
  screen.innerHTML = `
    <div class="card">
      <p><b>ë‚ ì§œ ì„ íƒ</b></p>
      <button onclick="seat()">2ì›” 27ì¼ (ê¸ˆ) 7PM</button>
      <button onclick="seat()">2ì›” 28ì¼ (í† ) 6PM</button>
      <button onclick="seat()">3ì›” 1ì¼ (ì¼) 5PM</button>
    </div>
  `;
}

/* ì¢Œì„ ì„ íƒ */
function seat(){
  function make(rate,zone){
    return Array.from({length:120},()=>`
      <div class="seat ${Math.random()<rate?'taken':'free'}"
      onclick="${Math.random()<rate
        ? "alert('ì´ë¯¸ ì„ íƒëœ ì¢Œì„ì…ë‹ˆë‹¤')"
        : `trySeat('${zone}')`}">
      </div>`).join("");
  }

  screen.innerHTML = `
    <p><b>KSPO DOME ì¢Œì„ ì„ íƒ</b></p>

    <div class="seat-zone">
      <div class="zone-title">ğŸ”¥ FLOOR (ê·¹ì•…)</div>
      <div class="seats">${make(0.95,'floor')}</div>
    </div>

    <div class="seat-zone">
      <div class="zone-title">1ì¸µ (ì–´ë ¤ì›€)</div>
      <div class="seats">${make(0.80,'one')}</div>
    </div>

    <div class="seat-zone">
      <div class="zone-title">2ì¸µ (ê·¸ë‚˜ë§ˆ ê°€ëŠ¥)</div>
      <div class="seats">${make(0.50,'two')}</div>
    </div>
  `;
}

function trySeat(zone){
  const rate = {floor:0.015, one:0.06, two:0.2}[zone];
  setTimeout(()=>{
    Math.random()<rate
      ? finish()
      : alert("ë‹¤ë¥¸ ê³ ê°ì´ ë¨¼ì € ì„ íƒí–ˆìŠµë‹ˆë‹¤");
  }, Math.random()*900+400);
}

/* ì„±ê³µ */
function finish(){
  const t = Math.floor(performance.now()-startTime);
  screen.innerHTML = `
    <div class="card center">
      <h2>ì˜ˆë§¤ ì„±ê³µ ğŸ‰</h2>
      <p>ë°˜ì‘ì†ë„ ${t}ms</p>
      <button onclick="location.reload()">ë‹¤ì‹œ ë„ì „</button>
    </div>
  `;
}

/* â­â­â­ ì´ ì¤„ì´ ì œì¼ ì¤‘ìš” */
start();
</script>
</body>
</html>
