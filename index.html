<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>INTERPARK PRACTICE</title>

<style>
body{margin:0;font-family:-apple-system;background:#f4f6fa}
#app{max-width:420px;margin:auto;height:100vh;display:flex;flex-direction:column}
h1{text-align:center;color:#0066cc;margin:12px 0}
#screen{flex:1;padding:16px;display:flex;flex-direction:column}

button{
  width:100%;padding:12px;border:none;border-radius:8px;
  background:#0066cc;color:#fff;font-size:15px;margin-top:8px
}
.card{background:#fff;border-radius:12px;padding:16px;margin-top:12px}
.center{text-align:center}
.bottom{margin-top:auto}

.calendar{
  display:grid;grid-template-columns:repeat(7,1fr);
  gap:6px;margin-top:12px
}
.day{padding:10px 0;border-radius:6px;background:#e9ecef;text-align:center}
.active{background:#0066cc;color:white}
.disabled{background:#ccc;color:#777}

.zone-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:5px}
.zone{padding:10px 0;border-radius:6px;text-align:center;font-weight:700;font-size:12px}
.floor{background:#ff6b6b}
.one{background:#ffd43b}
.two{background:#69db7c}

.seat-wrap{height:45vh;overflow:auto;background:#fff;border-radius:12px;padding:8px}
.seats{display:grid;grid-template-columns:repeat(24,1fr);gap:2px}
.seat{height:7px;border-radius:1px}
.free{background:#2db400}
.dead{background:#888}
</style>
</head>

<body>
<div id="app">
  <h1>INTERPARK</h1>
  <div id="screen"></div>
</div>

<script>
const screen=document.getElementById("screen");
let startTime=0, enterTime=0, finishTime=0;
let rank=0, selectedZone="";

function saveRanking(){
  const time=((finishTime-startTime)/1000).toFixed(2);
  let r=JSON.parse(localStorage.getItem("ranking")||"[]");
  r.push({time,rank,zone:selectedZone});
  r=r.sort((a,b)=>a.time-b.time).slice(0,10);
  localStorage.setItem("ranking",JSON.stringify(r));
}

/* ì‹œì‘ */
function start(){
  screen.innerHTML=`
    <div class="center"><h2 id="count"></h2></div>
    <div class="bottom">
      <button onclick="count()">ì‹œì‘í•˜ê¸°</button>
      <button onclick="showRanking()">ë­í‚¹ ë³´ê¸°</button>
    </div>
  `;
}

/* ì¹´ìš´íŠ¸ */
function count(){
  let c=5;
  screen.innerHTML=`
    <div class="center"><h2 id="count">5</h2></div>
    <div class="bottom">
      <button onclick="enter()">ì‹œì‘í•˜ê¸°</button>
    </div>
  `;
  const t=setInterval(()=>{
    c--;
    document.getElementById("count").innerText=c;
    if(c===0){
      startTime=performance.now();
      clearInterval(t);
    }
  },1000);
}

/* ëŒ€ê¸° ìˆœë²ˆ */
function enter(){
  if(startTime===0 || enterTime) return;
  enterTime=performance.now();
  const diff=enterTime-startTime;
  rank=Math.min(50000,Math.floor(6500+diff*18));
  screen.innerHTML=`<div class="card center">
    <p>ë‚˜ì˜ ëŒ€ê¸°ìˆœë²ˆ</p><h2>${rank}ë²ˆ</h2></div>`;
  setTimeout(calendar,5000);
}

/* ë‹¬ë ¥ */
let month=2;
function calendar(){
  const days=month===2?[27,28]:[1];
  screen.innerHTML=`
    <div class="card center">
      <h3>2026ë…„ ${month}ì›”</h3>
      <div class="calendar">
        ${Array.from({length:31},(_,i)=>{
          const d=i+1;
          if(days.includes(d))
            return `<div class="day active" onclick="selectDate(${d})">${d}</div>`;
          return `<div class="day disabled">${d}</div>`;
        }).join("")}
      </div>
      <button onclick="month=month===2?3:2;calendar()">â–¶</button>
    </div>
  `;
}

/* ë‚ ì§œ */
function selectDate(d){
  const t=d===27?"7PM":d===28?"6PM":"5PM";
  captcha(`${d}ì¼ ${t}`);
}

/* ë³´ì•ˆì½”ë“œ */
function captcha(info){
  const code=Math.random().toString(36).replace(/[^A-Z]/g,'').substring(0,6);
  screen.innerHTML=`
    <div class="card center">
      <p>${info}</p>
      <p><b>${code}</b></p>
      <input id="cap" oninput="this.value=this.value.toUpperCase().replace(/[^A-Z]/g,'')" placeholder="ë³´ì•ˆì½”ë“œ">
      <button onclick="check('${code}')">í™•ì¸</button>
    </div>
  `;
}
function check(c){
  if(document.getElementById("cap").value===c) zone();
  else alert("ë³´ì•ˆì½”ë“œ ì˜¤ë¥˜");
}

/* êµ¬ì—­ */
function zone(){
  const map=[
    2,2,2,1,1,'F','F',1,1,2,2,2,
    2,2,2,2,1,1,1,1,2,2,2,2
  ];
  screen.innerHTML=`
    <div class="zone-grid">
      ${map.map(z=>{
        const cls=z==='F'?'floor':z===1?'one':'two';
        const name=z==='F'?'FLOOR':z+'ì¸µ';
        return `<div class="zone ${cls}" onclick="seat('${cls}','${name}')">${name}</div>`;
      }).join("")}
    </div>
  `;
}

/* ì¢Œì„ */
function seat(cls,name){
  selectedZone=name;
  screen.innerHTML=`
    <button onclick="zone()">â† êµ¬ì—­</button>
    <div class="seat-wrap"><div class="seats">
      ${Array.from({length:480},()=>Math.random()<0.92
        ?`<div class="seat dead"></div>`
        :`<div class="seat free" onclick="trySeat(this)"></div>`
      ).join("")}
    </div></div>
  `;
}

function trySeat(el){
  if(Math.random()<0.5){
    el.className="seat dead";
    alert("ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë¨¼ì € ì„ íƒí–ˆìŠµë‹ˆë‹¤");
  }else{
    finishTime=performance.now();
    saveRanking();
    alert("ğŸ‰ ì˜ˆë§¤ ì™„ë£Œ");
    start();
  }
}

/* ë­í‚¹ */
function showRanking(){
  const r=JSON.parse(localStorage.getItem("ranking")||"[]");
  screen.innerHTML=`
    <div class="card">
      <h3>ğŸ† ë­í‚¹</h3>
      ${r.map((v,i)=>`
        <p>${i+1}. ${v.time}s / ${v.rank}ë²ˆ / ${v.zone}</p>
      `).join("")||"ê¸°ë¡ ì—†ìŒ"}
      <button onclick="start()">ëŒì•„ê°€ê¸°</button>
    </div>
  `;
}

start();
</script>
</body>
</html>